<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <title>æ–°å¢è´¦å•</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;max-width:720px;margin:24px auto;padding:0 16px;}
    h1{font-size:20px;margin:0 0 16px}
    .card{border:1px solid #eee;border-radius:10px;padding:16px;background:#fafafa}
    label{display:block;margin:10px 0 6px}
    input,textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:8px;font-size:14px}
    button{margin-top:14px;padding:10px 14px;border:0;border-radius:8px;background:#111;color:#fff;font-size:14px;cursor:pointer}
    button[disabled]{opacity:.6;cursor:not-allowed}
    .tip{margin:10px 0;color:#666}
    .nav{margin-bottom:14px}
    .nav a{margin-right:12px}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <div class="nav"><a href="/">â† è¿”å›åˆ—è¡¨</a></div>
  <h1>ğŸ“ æ–°å¢è´¦å•</h1>
  <div class="card">
    <div class="tip">å¸¦æ˜Ÿå·çš„æ˜¯å¿…å¡«é¡¹ã€‚</div>
    <form id="f">
      <label>æäº¤äººå§“å *</label>
      <input id="name" required placeholder="ä¾‹å¦‚ï¼šAlice" />

      <label>é‡‘é¢ï¼ˆMYRï¼‰ *</label>
      <input id="amount" required type="number" step="0.01" min="0" placeholder="ä¾‹å¦‚ï¼š120.50" />

      <label>ç”¨é€”ï¼ˆä¹°äº†å•¥/ç”¨åœ¨å“ªé‡Œï¼‰ *</label>
      <textarea id="purpose" required rows="2" placeholder="ä¾‹å¦‚ï¼šä¹°æ‰“å°çº¸"></textarea>

      <label>é“¶è¡Œ *</label>
      <input id="bank" required placeholder="ä¾‹å¦‚ï¼šMaybank" />

      <label>è´¦æˆ·å· *</label>
      <input id="acct" required placeholder="ä¾‹å¦‚ï¼š112-345-6789" />

      <button id="btn" type="submit">æäº¤è´¦å•</button>
      <div id="msg" class="tip"></div>
    </form>
  </div>

  <script>
    // ç”¨ä½ çš„ URL å’Œ anon key æ›¿æ¢ä¸‹é¢ä¸¤è¡Œ
    const SUPABASE_URL = "https://jdzytjocdkuzjtuwygdl.supabase.co";           // ä¾‹å¦‚ï¼šhttps://jdzytjocdkuzjtuwygdl.supabase.co
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impkenl0am9jZGt1emp0dXd5Z2RsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2MjA2MjgsImV4cCI6MjA3NjE5NjYyOH0.jP-CwOVxYhfHXGOz_l_Q7Xc-umLIcJQH0_LJZSUAxNw"; // ä½ çš„ anon key

    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const form = document.getElementById('f');
    const btn = document.getElementById('btn');
    const msg = document.getElementById('msg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      btn.disabled = true; msg.textContent = 'æäº¤ä¸­â€¦';

      const payload = {
        submitter_name: document.getElementById('name').value.trim(),
        amount: Number(document.getElementById('amount').value),
        purpose: document.getElementById('purpose').value.trim(),
        bank_name: document.getElementById('bank').value.trim(),
        account_no: document.getElementById('acct').value.trim(),
        status: 'å·²æäº¤'
      };

      // ç®€å•æ ¡éªŒ
      if (!payload.submitter_name || !payload.amount || !payload.purpose || !payload.bank_name || !payload.account_no) {
        msg.textContent = 'è¯·æŠŠå¸¦æ˜Ÿå·çš„å†…å®¹å¡«å®Œæ•´ã€‚';
        btn.disabled = false; return;
      }

      const { error } = await supabase.from('claims').insert(payload);
      if (error) {
        console.error(error);
        msg.textContent = 'æäº¤å¤±è´¥ï¼š' + error.message;
        btn.disabled = false; return;
      }

      msg.textContent = 'æäº¤æˆåŠŸï¼å³å°†è¿”å›åˆ—è¡¨â€¦';
      setTimeout(() => { window.location.href = '/'; }, 800);
    });
  </script>
</body>
</html>
